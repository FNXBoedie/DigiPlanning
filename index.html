<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personeelsplanner 2025</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f3f4f6;
            padding: 2rem;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        h1 {
            font-size: 1.875rem;
            font-weight: bold;
            margin-bottom: 2rem;
        }

        .menu-button {
            background: #4b5563;
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            margin-bottom: 1rem;
        }

        .menu-content {
            background: white;
            padding: 1rem;
            border-radius: 0.375rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .menu-content.active {
            display: block;
        }

        .input-group {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        input {
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
        }

        button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
        }

        .btn-add {
            background: #3b82f6;
            color: white;
        }

        .btn-delete {
            background: #ef4444;
            color: white;
            padding: 0.5rem 1rem;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .grid-item {
            background: white;
            padding: 1rem;
            border-radius: 0.375rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .week-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .btn-nav {
            background: #e5e7eb;
            color: #374151;
        }

        .date-picker {
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            cursor: pointer;
        }

        .schedule-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            background: white;
            border-radius: 0.375rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border-collapse: collapse;
        }

        th, td {
            padding: 0.5rem;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }

        select {
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            width: 100%;
        }
        .geslotenDateShift, .geslotenDateActivity {
            width: auto;
            flex: 0.7;
        }
        .geslotenDateActivityText {
            flex: 2;
        }

        .shift-cell {
            display: flex;
            flex-direction: row;
            gap: 0.25rem;
        }

        .shift-wrapper {
            flex: 1;
        }

        .shift-label {
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 0.25rem;
        }

        select {
            font-size: 0.875rem;
        }
        .view-toggle {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .view-button {
            background: #e5e7eb;
            color: #374151;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
        }

        .view-button.active {
            background: #4b5563;
            color: white;
        }
        .employee-button {
    padding: 0.5rem 1rem;   /* Adjust padding if necessary */
    width: 110px;           /* Set a fixed width for all buttons */
    text-align: center;     /* Ensure text is centered */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 style="text-align: center;">DigiPlanning</h1>

        <div class="view-toggle">
            <button class="view-button active" data-view="calendar">Kalender</button>
            <button class="view-button" data-view="employee">Werknemers</button>
            <button class="view-button" data-view="location">Locaties</button>
             <button class="view-button" data-view="gesloten">Gesloten</button>
        </div>

        
        
        <div id="menuContent" class="menu-content" style="display: none;">
            <div id="employeeView" style="display: none;">
                <div class="input-group">
                    <input type="text" id="newEmployeeName" placeholder="Naam Werknemer">
                    <button class="btn-add" onclick="handleAddEmployee()">Toevoegen</button>
                </div>
                <h2>Werknemers</h2>
                <div id="employeesList" class="grid"></div>
            </div>

            <div id="locationView" style="display: none;">
                <div class="input-group">
                    <input type="text" id="newLocationName" placeholder="Naam Locatie">
                    <button class="btn-add" onclick="handleAddLocation()">Toevoegen</button>
                </div>
                <h2>Locaties</h2>
                <div id="locationsList" class="grid"></div>
            </div>

           <div id="geslotenView" style="display: none;">
               <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;"> <!-- Added margin-bottom -->
                   <h2>Gesloten Dagen</h2>
                   <button class="btn-add" onclick="addGeslotenDateInput()">+</button>
               </div>
               <div id="geslotenDateInputs">
                    <div class="input-group">
                        <input type="date" class="date-picker geslotenDate">
                        <select class="geslotenDateShift">
                            <option value="">Selecteer Shift</option>
                            <option value="voormiddag">Voormiddag</option>
                            <option value="namiddag">Namiddag</option>
                            <option value="beide">Beide</option>
                        </select>
                        <select class="geslotenDateActivity">
                            <option value="">Selecteer Activiteit</option>
                            <option value="overleg">Overleg</option>
                            <option value="ziek">Ziek</option>
                            <option value="verlof">Verlof</option>
                            <option value="staking">Staking</option>
                            <option value="opleiding">Opleiding</option>
                            <option value="feestdag">Feestdag</option>
                        </select>
                        <input type="text" class="geslotenDateActivityText" placeholder="Specifieke Activiteit">
                        <button class="btn-add" onclick="applyGeslotenDate(this.parentNode)">Toepassen</button>
                        <button class="btn-delete" onclick="deleteGeslotenDateInput(this.parentNode)">Verwijderen</button>
                    </div>
                </div>
                 <div class="input-group">
                    <select id="geslotenWeekday">
                        <option value="">Selecteer Weekdag</option>
                        <option value="0">Maandag</option>
                        <option value="1">Dinsdag</option>
                        <option value="2">Woensdag</option>
                        <option value="3">Donderdag</option>
                        <option value="4">Vrijdag</option>
                    </select>
                    <select id="geslotenShift">
                        <option value="">Selecteer Shift</option>
                        <option value="voormiddag">Voormiddag</option>
                        <option value="namiddag">Namiddag</option>
                    </select>
                     <select id="geslotenActivity">                
                        <option value="overleg">Overleg</option>
                    </select>
                    <button class="btn-add" onclick="applyGesloten()">Toepassen</button>
                    <button class="btn-delete" onclick="removeGesloten()">Verwijderen</button>
                </div>
            </div>
        </div>

        <div class="week-nav" style="display: flex; justify-content: center; align-items: center; gap: 1rem;">
            <button class="btn-nav" onclick="changeWeek(-1)">Vorige Week</button>
            <input type="date" id="datePicker" class="date-picker" onchange="handleDateChange(this.value)">
            <button class="btn-nav" onclick="changeWeek(1)">Volgende Week</button>
        </div>

        <div class="schedule-container">
            <table>
                <thead>
                    <tr id="weekDays">
                        <th style="text-align: center;">Werknemer</th>
                        
                    </tr>
                </thead>
                <tbody id="scheduleBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        // State management
        let employees = [];
        let locations = [];
        let schedule = {};
        let currentWeek = new Date();
        let filteredEmployeeId = null;
        const daysOfWeek = ['Ma', 'Di', 'Wo', 'Do', 'Vr'];
        const shifts = ['voormiddag', 'namiddag'];

        // Menu toggle

        // View toggle
        const viewButtons = document.querySelectorAll('.view-button');
        const menuContent = document.getElementById('menuContent');
        const employeeView = document.getElementById('employeeView');
        const locationView = document.getElementById('locationView');
        const geslotenView = document.getElementById('geslotenView');
        const calendarView = document.querySelector('.schedule-container');
        const weekNav = document.querySelector('.week-nav');
        const geslotenWeekday = document.getElementById('geslotenWeekday');
        const geslotenDate = document.getElementById('geslotenDate');
        const geslotenDateShift = document.getElementById('geslotenDateShift');
        const geslotenDateActivity = document.getElementById('geslotenDateActivity');
        const geslotenDateInputs = document.getElementById('geslotenDateInputs');

        // Initially show the calendar and hide the menu content
        menuContent.style.display = 'none';
        calendarView.style.display = 'block';
        weekNav.style.display = 'flex';

        function addGeslotenDateInput() {
            const newInputGroup = document.createElement('div');
            newInputGroup.classList.add('input-group');
            newInputGroup.innerHTML = `
                <input type="date" class="date-picker geslotenDate">
                <select class="geslotenDateShift">
                    <option value="">Selecteer Shift</option>
                    <option value="voormiddag">Voormiddag</option>
                    <option value="namiddag">Namiddag</option>
                    <option value="beide">Beide</option>
                </select>
                <select class="geslotenDateActivity">
                    <option value="">Selecteer Activiteit</option>
                    <option value="overleg">Overleg</option>
                    <option value="ziek">Ziek</option>
                    <option value="verlof">Verlof</option>
                    <option value="staking">Staking</option>
                    <option value="opleiding">Opleiding</option>
                    <option value="feestdag">Feestdag</option>
                </select>
                <input type="text" class="geslotenDateActivityText" placeholder="Specifieke Activiteit">
                <button class="btn-add" onclick="applyGeslotenDate(this.parentNode)">Toepassen</button>
                <button class="btn-delete" onclick="deleteGeslotenDateInput(this.parentNode)">Verwijderen</button>
            `;
            geslotenDateInputs.appendChild(newInputGroup);
        }

        function deleteGeslotenDateInput(inputGroup) {
            const dateInput = inputGroup.querySelector('.geslotenDate');
            const date = dateInput.value;
             const dateString = formatDate(new Date(date));
             employees.forEach(emp => {
                if (schedule[dateString] && schedule[dateString][emp.id]) {
                    delete schedule[dateString][emp.id];
                }
            });
            inputGroup.remove();
            renderSchedule();
        }

        viewButtons.forEach(button => {
            button.addEventListener('click', function() {
                viewButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                const view = this.dataset.view;
                if (view === 'employee') {
                    employeeView.style.display = 'block';
                    menuContent.style.display = 'block';
                    locationView.style.display = 'none';
                    calendarView.style.display = 'none';
                    weekNav.style.display = 'none';
                     geslotenWeekday.style.display = 'none';
                     geslotenDate.style.display = 'none';
                     geslotenDateShift.style.display = 'none';
                     geslotenDateActivity.style.display = 'none';
                } else if (view === 'location') {
                    employeeView.style.display = 'none';
                    locationView.style.display = 'block';
                    menuContent.style.display = 'block';
                    calendarView.style.display = 'none';
                    weekNav.style.display = 'none';
                     geslotenWeekday.style.display = 'none';
                     geslotenDate.style.display = 'none';
                     geslotenDateShift.style.display = 'none';
                     geslotenDateActivity.style.display = 'none';
                } else if (view === 'calendar') {
                    employeeView.style.display = 'none';
                    locationView.style.display = 'none';
                    menuContent.style.display = 'none';
                    calendarView.style.display = 'block';
                    weekNav.style.display = 'flex';
                    geslotenView.style.display = 'none';
                     geslotenWeekday.style.display = 'none';
                     geslotenDate.style.display = 'none';
                     geslotenDateShift.style.display = 'none';
                     geslotenDateActivity.style.display = 'none';
                } else if (view === 'gesloten') {
                    employeeView.style.display = 'none';
                    locationView.style.display = 'none';
                    menuContent.style.display = 'block';
                    calendarView.style.display = 'none';
                    weekNav.style.display = 'none';
                    geslotenView.style.display = 'block';
                     geslotenWeekday.style.display = 'block';
                     geslotenDate.style.display = 'block';
                     geslotenDateShift.style.display = 'block';
                     geslotenDateActivity.style.display = 'block';
                } else {
                    employeeView.style.display = 'none';
                    locationView.style.display = 'none';
                    menuContent.style.display = 'none';
                    calendarView.style.display = 'none';
                    weekNav.style.display = 'none';
                    geslotenView.style.display = 'none';
                     geslotenWeekday.style.display = 'none';
                     geslotenDate.style.display = 'none';
                     geslotenDateShift.style.display = 'none';
                     geslotenDateActivity.style.display = 'none';
                }
            });
        });

        // Helper functions
        function getWeekDates(date) {
            const start = new Date(date);
            const day = start.getDay();
            const diff = start.getDate() - day + (day === 0 ? -6 : 1);
            start.setDate(diff);
            
            return Array.from({ length: 5 }).map((_, i) => {
                const day = new Date(start);
                day.setDate(start.getDate() + i);
                return day;
            });
        }

        function formatDate(date) {
            return date.toISOString().split('T')[0];
        }

        function handleDateChange(value) {
            currentWeek = new Date(value);
            renderWeekDays();
            renderSchedule();
            updateDatePicker();
        }

        function updateDatePicker() {
            const datePicker = document.getElementById('datePicker');
            datePicker.value = formatDate(currentWeek);
        }

        // Employee management
        function handleAddEmployee() {
            const input = document.getElementById('newEmployeeName');
            const name = input.value.trim();
            if (name) {
                const newEmployee = {
                    id: `emp-${Date.now()}`,
                    name: name
                };
                employees.push(newEmployee);
                input.value = '';
                renderEmployees();
                renderSchedule();
            }
        }

        function handleDeleteEmployee(id) {
            employees = employees.filter(emp => emp.id !== id);
            renderEmployees();
            renderSchedule();
        }

        function renderEmployees() {
            const list = document.getElementById('employeesList');
            list.innerHTML = employees.map(emp => `
                <div class="grid-item">
                    <span>${emp.name}</span>
                    <button class="btn-delete" onclick="handleDeleteEmployee('${emp.id}')">Verwijderen</button>
                </div>
            `).join('');
        }

        // Location management
        function handleAddLocation() {
            const input = document.getElementById('newLocationName');
            const name = input.value.trim();
            if (name) {
                const newLocation = {
                    id: `loc-${Date.now()}`,
                    name: name
                };
                locations.push(newLocation);
                input.value = '';
                renderLocations();
                renderSchedule();
            }
        }

        function handleDeleteLocation(id) {
            locations = locations.filter(loc => loc.id !== id);
            renderLocations();
            renderSchedule();
        }

        function renderLocations() {
            const list = document.getElementById('locationsList');
            list.innerHTML = locations.map(loc => `
                <div class="grid-item">
                    <span>${loc.name}</span>
                    <button class="btn-delete" onclick="handleDeleteLocation('${loc.id}')">Verwijderen</button>
                </div>
            `).join('');
        }

        function applyGesloten() {
            const weekday = document.getElementById('geslotenWeekday').value;
            const shift = document.getElementById('geslotenShift').value;
            const activity = document.getElementById('geslotenActivity').value;

            if (!weekday || !shift || !activity) {
                alert('Please select a weekday, shift, and activity.');
                return;
            }

            const selectedWeekday = parseInt(weekday);
            const selectedShift = shift;
            const selectedActivity = activity;

            const startDate = new Date(currentWeek.getFullYear(), 0, 1);
            const endDate = new Date(currentWeek.getFullYear() + 1, 0, 1);

            for (let date = startDate; date < endDate; date.setDate(date.getDate() + 1)) {
                const dayOfWeek = date.getDay();
                 console.log("Date:", date, "Day of week:", dayOfWeek);
                if (dayOfWeek === selectedWeekday + 2) {
                    const dateString = formatDate(date);
                    employees.forEach(emp => {
                        if (!schedule[dateString]) {
                            schedule[dateString] = {};
                        }
                        if (!schedule[dateString][emp.id]) {
                            schedule[dateString][emp.id] = {};
                        }
                        schedule[dateString][emp.id][selectedShift] = selectedActivity;
                    });
                }
            }
            
             const weekDates = getWeekDates(currentWeek);
            weekDates.forEach(date => {
                 const dayOfWeek = date.getDay();
                 console.log("Date:", date, "Day of week:", dayOfWeek);
                if (dayOfWeek === selectedWeekday + 1) {
                    const dateString = formatDate(date);
                     employees.forEach(emp => {
                        if (!schedule[dateString]) {
                            schedule[dateString] = {};
                        }
                        if (!schedule[dateString][emp.id]) {
                            schedule[dateString][emp.id] = {};
                        }
                         schedule[dateString][emp.id][selectedShift] = selectedActivity;
                    });
                }
            });
            renderSchedule();
        }

        function applyGeslotenDate() {
            const inputGroups = document.querySelectorAll('#geslotenDateInputs .input-group');
            inputGroups.forEach(group => {
                const dateInput = group.querySelector('.geslotenDate');
                const shiftSelect = group.querySelector('.geslotenDateShift');
                const activitySelect = group.querySelector('.geslotenDateActivity');
                const activityText = group.querySelector('.geslotenDateActivityText');

                const date = dateInput.value;
                const shift = shiftSelect.value;
                const activity = activitySelect.value;
                const specificActivity = activityText.value.trim();

                 if (!date || !shift) {
                    alert('Please select a date and shift.');
                    return;
                }
                 if (!activity && !specificActivity) {
                    alert('Please select or specify an activity.');
                    return;
                }
                let finalActivity = activity;
                if (specificActivity) {
                    finalActivity = specificActivity;
                }

                const dateString = formatDate(new Date(date));

                employees.forEach(emp => {
                    if (!schedule[dateString]) {
                        schedule[dateString] = {};
                    }
                    if (!schedule[dateString][emp.id]) {
                        schedule[dateString][emp.id] = {};
                    }
                    if (shift === 'beide') {
                        schedule[dateString][emp.id]['voormiddag'] = activity;
                        schedule[dateString][emp.id]['namiddag'] = activity;
                    } else {
                        schedule[dateString][emp.id][shift] = activity;
                    }
                });
            });
            renderSchedule();
        }

        // Schedule management
        function handleLocationChange(date, employeeId, shift, locationId) {
            if (!schedule[date]) {
                schedule[date] = {};
            }
            if (!schedule[date][employeeId]) {
                schedule[date][employeeId] = {};
            }
            schedule[date][employeeId][shift] = locationId;
            renderSchedule();
        }

        function changeWeek(offset) {
            currentWeek.setDate(currentWeek.getDate() + (offset * 7));
            renderWeekDays();
            renderSchedule();
            updateDatePicker();
        }

        function renderWeekDays() {
            const weekDates = getWeekDates(currentWeek);
            const headerRow = document.getElementById('weekDays');
            headerRow.innerHTML = `
                <th style="text-align: center;">Werknemer</th>
                ${weekDates.map((date, index) => `
                    <th style="text-align: center;">${daysOfWeek[index]} ${date.getDate()}/${date.getMonth() + 1} <br> </th>
                `).join('')}
            `;
        }

        function filterSchedule(employeeId) {
            if (filteredEmployeeId === employeeId) {
                filteredEmployeeId = null;
            } else {
                filteredEmployeeId = employeeId;
            }
            renderSchedule();
        }

        function renderSchedule() {
            const weekDates = getWeekDates(currentWeek);
            const tbody = document.getElementById('scheduleBody');
            
            let filteredEmployees = employees;
            if (filteredEmployeeId) {
                filteredEmployees = employees.filter(emp => emp.id === filteredEmployeeId);
            }

            tbody.innerHTML = filteredEmployees.map(emp => `
                <tr>
                    <td><button class="employee-button" onclick="filterSchedule('${emp.id}')">${emp.name}</button></td>
                    ${weekDates.map(date => {
                        const dateString = formatDate(date);
                        return `
                            <td>
                                <div class="shift-cell">
                                    ${shifts.map(shift => {
                                        const locationId = schedule[dateString]?.[emp.id]?.[shift] || '';
                                        return `
                                            <div class="shift-wrapper">
                                                <div class="shift-label"></div>
                                                <select onchange="handleLocationChange('${dateString}', '${emp.id}', '${shift}', this.value)">
                                                    <option value="">Locatie</option>
                                                    ${locations.map(loc => `
                                                        <option value="${loc.id}" ${locationId === loc.id ? 'selected' : ''}>
                                                            ${loc.name}
                                                        </option>
                                                    `).join('')}
                                                    <option disabled>---</option>
                                                    <option value="overleg" ${locationId === 'overleg' ? 'selected' : ''}>Overleg</option>
                                                    <option value="ziek" ${locationId === 'ziek' ? 'selected' : ''}>Ziek</option>
                                                    <option value="verlof" ${locationId === 'verlof' ? 'selected' : ''}>Verlof</option>
                                                    <option value="staking" ${locationId === 'staking' ? 'selected' : ''}>Staking</option>
                                                    <option value="opleiding" ${locationId === 'opleiding' ? 'selected' : ''}>Opleiding</option>
                                                     <option value="feestdag" ${locationId === 'feestdag' ? 'selected' : ''}>Feestdag</option>
                                                </select>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </td>
                        `;
                    }).join('')}
                </tr>
            `).join('');
        }

        function removeGesloten() {
            const weekday = document.getElementById('geslotenWeekday').value;
            const shift = document.getElementById('geslotenShift').value;

            if (!weekday || !shift) {
                alert('Please select a weekday and shift to remove.');
                return;
            }

            const selectedWeekday = parseInt(weekday);
            const selectedShift = shift;

            const startDate = new Date(currentWeek.getFullYear(), 0, 1);
            const endDate = new Date(currentWeek.getFullYear() + 1, 0, 1);

            for (let date = startDate; date < endDate; date.setDate(date.getDate() + 1)) {
                const dayOfWeek = date.getDay();
                if (dayOfWeek === selectedWeekday + 2) {
                    const dateString = formatDate(date);
                    employees.forEach(emp => {
                        if (schedule[dateString] && schedule[dateString][emp.id]) {
                            delete schedule[dateString][emp.id][selectedShift];
                        }
                    });
                }
            }
             const weekDates = getWeekDates(currentWeek);
            weekDates.forEach(date => {
                 const dayOfWeek = date.getDay();
                if (dayOfWeek === selectedWeekday + 1) {
                    const dateString = formatDate(date);
                     employees.forEach(emp => {
                        if (schedule[dateString] && schedule[dateString][emp.id]) {
                            delete schedule[dateString][emp.id][selectedShift];
                        }
                    });
                }
            });
            renderSchedule();
        }

        // Initial render
        updateDatePicker();
        renderWeekDays();
        renderSchedule();
    </script>
</body>
</html>
